1.pip 업그레이드
python -m pip install --upgrade pip --trusted-host pypi.org --trusted-host files.pythonhosted.org

2.주피터노트북 설치
pip install jupyter --trusted-host pypi.org --trusted-host files.pythonhosted.org

3.패키지 설치
pip install pyautogui clipboard datetime pywinauto selenium opencv-python pillow openpyxl pandas lxml xlrd bs4 requests html5lib --trusted-host pypi.org --trusted-host files.pythonhosted.org

4.activate() 에러시 대안 
import pywinauto #설치 필요
win = pg.getWindowsWithTitle("제목 없음")[0]
pywinauto.application.Application().connect(handle=win._hWnd).top_window().set_focus()
pg.sleep(1)
win.activate()


웹크롤링 코드
eduMngtDeptName = '디지털혁신교육그룹' #교육부서
searchStartDt = '20220101' #교육기간 검색 시작일
searchEndDt = '20221231' #교육기간 검색 종료일
keyword = '뉴칼라 Level1_PY' #과정명 검색 키워드

# 모듈 불러오기
import requests
import pandas as pd
import pyautogui as pg

requests.packages.urllib3.disable_warnings(requests.packages.urllib3.exceptions.InsecureRequestWarning) #경고문구 제거

header = {
      'User-Agent':'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/96.0.4664.110 Safari/537.36 Edg/96.0.1054.62'
      }

lp_id = ""
lp_pw = pg.password(title="lp패스워드", text="패스워드 입력하기")

# LP접속 url : 로그인 페이지에서 로그기록 하면서 로그인(XHR)
url = "https://lp.posco.co.kr/S22/S22A10/member/login/ajax/login.do"

#payload에서 마리미터 확인
form_data = {"email":lp_id, "password":lp_pw}

# session생성
s = requests.session()

# 세션을 통해 로그인하기
login_page = s.post(url, data=form_data, verify=False, headers=header)

# 로그인 된 상태에서 차수명 리스트 검색하기 : 검색하고 url 추출
list_url = "https://lp.posco.co.kr/S22/S22A10/admin/course/ajax/courseCsPageList.do"

form_data = {"start":"0",
"length":"500","keywordType":"C",
"eduMngtDeptName":eduMngtDeptName,
"eduPeriodFlag":"C",
"searchStartDt":searchStartDt,
"searchEndDt":searchEndDt,
"keyword":keyword}

# lp 차수명 리스트 접속
res = s.post(list_url, data=form_data, verify=False, headers=header)

#preview에서 확인하면 딕셔너리의 json 데이터로 되어 있음
results = res.json() #json 파싱

course_list = results["data"]
course_list #리스트 안에 딕셔너리로 되어 있음

# 차수의 운영관리 에 들어가서 URL 추출
course_url = "https://lp.posco.co.kr/S22/S22A10/admin/course/ajax/courseRegisterStudentList.do"

# 상위에서 추출된 차수들의 차수명 id정보 추출 - 운영관리에 들러갈 파라미터값을 추추루한 것임
course_data = []
for list in course_list:
    courseSeq = list["courseSeq"]
    courseCsSeq = list["courseCsSeq"]
    data = {"courseSeq" :courseSeq, "courseCsSeq" :courseCsSeq}
    course_data.append(data)

course_data

# 각 차수별 학습자 리스트 url

c_m_list = []
for fd in course_data:
    form_data = fd
    res = s.post(course_url, data=fd, verify=False)
    members = res.json()
    
    for member in members["data"]:
        c_name = member["courseCsName"]
        c_c_name = member["courseName"]
        m_company = member["compName"]
        c_date = member["eduDt"]
        stat = member["registerStatName"]
        m_id = member["memberNo"]
        name = member["userName"]
        email = member["email"]
        try: workLocationName = member["workLocationName"]
        except: workLocationName = '지역 없음'

        member_info = {"교육과정명_통합":c_c_name, 
        "교육과정명" : c_name, 
        "교육기간From" : c_date.split("~")[0],
        "교육기간End" : c_date.split("~")[-1],
        "학습자소속회사" : m_company,
        "성명" : name,
        "직번" : m_id,
        "이메일" : email,
        "지역" : workLocationName,
        "수강현황" : stat
        }
        c_m_list.append(member_info)
        
  df = pd.DataFrame(c_m_list)
  df = df.loc[(df['수강현황'] != '수강취소') & (df['지역'] == '포항')]
  df.to_excel("교육과정별 수강신청 리스트.xlsx")
